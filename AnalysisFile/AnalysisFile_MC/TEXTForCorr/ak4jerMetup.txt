        int CORR_idxlist_MET[100] = {0};
        int idx_CORR_MET = 0;
        double Correction_METx = RMET_pt * TMath::Cos(RMET_phi);
        double Correction_METy = RMET_pt * TMath::Sin(RMET_phi);
        for(int jj = 0 ; jj < RnJet ; jj++){
            if(RJet_pt[jj] < 18) continue;
            double Correction_dpx = RJet_pt[jj] * TMath::Cos(RJet_phi[jj]);
            double Correction_dpy = RJet_pt[jj] * TMath::Sin(RJet_phi[jj]);
            Correction_METx += Correction_dpx;
            Correction_METy += Correction_dpy;
            CORR_idxlist_MET[idx_CORR_MET] = jj;
            idx_CORR_MET += 1;
        }
        for(int jj = 0 ; jj < idx_CORR_MET ; jj++){
            double Correction_dpx = RJet_pt[CORR_idxlist_MET[jj]] * TMath::Cos(RJet_phi[CORR_idxlist_MET[jj]]);
            double Correction_dpy = RJet_pt[CORR_idxlist_MET[jj]] * TMath::Sin(RJet_phi[CORR_idxlist_MET[jj]]);
            Correction_dpx *= (1 - P_Ak4Jet_Scale->GetBinContent(P_Ak4Jet_Scale->FindBin(RJet_eta[CORR_idxlist_MET[jj]],RJet_pt[CORR_idxlist_MET[jj]])));
            Correction_dpy *= (1 - P_Ak4Jet_Scale->GetBinContent(P_Ak4Jet_Scale->FindBin(RJet_eta[CORR_idxlist_MET[jj]],RJet_pt[CORR_idxlist_MET[jj]])));
            Correction_METx -= Correction_dpx;
            Correction_METy -= Correction_dpy;
        }
        RMET_pt = TMath::Sqrt(Correction_METx * Correction_METx + Correction_METy * Correction_METy);
